function echo(e){document.write(e)}function get(e){return document.getElementById(e)}function pos(e,t){return e+"+"+t}function up(e,t){board[e][t]=get(pos(e,t)).value}function upall(){for(var e=0;x>e;e++)for(var t=0;y>t;t++)up(e,t)}function checkall(){for(var e=0;x>e;e++)for(var t=0;y>t;t++)if(board[e][t]>max)return alert(text.tooHigh+board[e][t]+"."),void 0}function make2DArray(e,t){for(var n=new Array,i=0;e>i;i++)n[i]=new Array;for(var i=0;e>i;i++)for(var r=0;t>r;r++)n[i][r]=0;return n}function toInt(e){var t=0;switch(e){case"A":case"a":t=1;break;case"B":case"b":t=2;break;case"C":case"c":t=3;break;case"D":case"d":t=4;break;case"E":case"e":t=5;break;case"F":case"f":t=6;break;case"G":case"g":t=7;break;case"H":case"h":t=8;break;case"I":case"i":t=9;break;case"J":case"j":t=10;break;case"K":case"k":t=11;break;case"L":case"l":t=12;break;case"M":case"m":t=13;break;case"N":case"n":t=14;break;case"O":case"o":t=15;break;case"P":case"p":t=16;break;case"Q":case"q":t=17;break;case"R":case"r":t=18;break;case"S":case"s":t=19;break;case"T":case"t":t=20;break;case"U":case"u":t=21;break;case"V":case"v":t=22;break;case"W":case"w":t=23;break;case"X":case"x":t=24;break;case"Y":case"y":t=25;break;case"Z":case"z":t=26;break;default:t=0}return t}function decode(e){for(var t,n=0,i=0,r=0;r<e.length;r++)t=e.charAt(r),"|"==t?(n++,i=0):t.toUpperCase()==t?(board[n][i]=soln[n][i]=toInt(t),consf[n][i]=!0,i++):(board[n][i]=0,soln[n][i]=toInt(t),consf[n][i]=!1,i++);x=i,y=n+1}function gameWon(){for(var e=0,t=0,e=0;x>e;e++)for(var t=0;y>t;t++)if(board[e][t]!=soln[e][t])return!1;return!0}function checkSoln(){if(upall(),checkall(),update(2),gameWon())return update(1),void 0;var e,t,n,i,r=make2DArray(x,y);for(t=0;y>t;t++)for(e=0;x>e;e++)for(n=e+1;x>n;n++)board[e][t]&&board[n][t]&&board[e][t]==board[n][t]&&(r[e][t]=r[n][t]=!0);for(e=0;x>e;e++)for(t=0;y>t;t++)for(n=t+1;y>n;n++)board[e][t]&&board[e][n]&&board[e][t]==board[e][n]&&(r[e][t]=r[e][n]=!0);var s,a;for(s=0;x>s;s+=w)for(a=0;y>a;a+=l)for(e=s;s+w>e;e++)for(t=a;a+l>t;t++)for(n=s;s+w>n;n++)for(i=a;a+l>i;i++)n!=e&&i!=t&&board[e][t]&&board[n][i]&&board[e][t]==board[n][i]&&(r[e][t]=r[n][i]=!0);for(e=0;x>e;e++)for(t=0;y>t;t++)board[e][t]&&board[e][t]>max&&(r[e][t]=!0);var o=!0;for(e=0;x>e;e++)for(t=0;y>t;t++)board[e][t]||(o=!1);if(o)for(e=0;x>e;e++)for(t=0;y>t;t++)IsNumeric(board[e][t])||(r[e][t]=!0);for(e=0;x>e;e++)for(t=0;y>t;t++)get(pos(e,t)).className=consf[e][t]?r[e][t]?"cerror":"const":r[e][t]?"error":"user"}function IsNumeric(e){return!isNaN(parseFloat(e))}function draw(){var e,t,n,i="size='1' maxlength='"+(x>9||y>9?2:1)+"' onkeyup='checkSoln();'",r='<center><table border="1" cellpadding="1" cellspacing="0">';for(e=0;x>e;e++){if(r+="<tr>",0==e%w&&0!=e){for(t=0;y>t;t++)0==t%l&&0!=t&&(r+='<td style="background:rgb(64,64,64)" align="center"><img src="'+im.src+'" alt="" width="5" height="5"/></td>'),r+='<td style="background:rgb(64,64,64)" align="center"><img src="'+im.src+'" alt="" width="5" height="5"/></td>';r+="</tr>",r+="<tr>"}for(t=0;y>t;t++)0==t%l&&0!=t&&(r+='<td style="background:rgb(64,64,64)" align="center"><img src="'+im.src+'" alt="" width="5" height="5"/></td>'),n="id='"+pos(e,t)+"'"+(consf[e][t]?" class='const' value='"+soln[e][t]+"' readonly='readonly'":"class='user'"),r+='<td align="center"><input '+n+" "+i+"/></td>";r+="</tr>"}r+="</table></center>",r+='<input type="submit" style="visibility:hidden"/>',get("sudoku").innerHTML=r}var max=l*w,soln=make2DArray(max,max),board=make2DArray(max,max),consf=make2DArray(max,max),x=0,y=0,im=new Image;if(im.src="/caribou/games/images/clear.gif",isTest!==!1)var isTest=!0;if(!lang)var lang="en";decode(str),(x!=y||2>x||2>y)&&alert("Improper format. The sudoku puzzle is not a square, or an illegal size.");var text=new Object;"en"==lang?(text.alertText="You won! Congratulations! Don't forget to submit your answer below if it is not submitted automatically.",text.tooHigh="One of your values is too high. The maximum possible value is "+max+", you have a value of ",text.instruct="- In Sudoku, the objective is to fill the "+max+"x"+max+" grid with numbers such that each row, each column, and each region contains exactly one of each number from 1 to "+max+".- Regions are "+l+"x"+w+" in size, and are separated by a blank row or column. The blue numbers are correct, and cannot be changed.<br/>- Numbers that conflict with other numbers on the board will be highlighted in red, and must be corrected to win the game.<br/>",text.testRules='- Try as often as you like (but beware of the remaining test time!)<br/>- If you manage to win, scroll down, click "Submit Answer", and you will be awarded full marks.<br/>'):"fr"==lang&&(text.alertText="Vous avez gagn\u00E9! Votre victoire sera soumis automatiquement.",text.tooHigh="Un de vos valeurs est trop \u00E9lev\u00E9. La valeur maximale possible est "+max+", vous avez une valeur de ",text.instruct="- Dans le jeu Sudoku, le but est de remplir la grille de "+max+"x"+max+" cases avec des chiffres de telle sorte &#224; ce que chaque ligne et chaque colonne ainsi que chaque r&#233;gion de "+l+" x "+w+" cases contiennent exactement un des quatre chiffre de 1 &#224; "+max+".<br/>- Les r&#233;gions sont de "+l+"x"+w+" cases, et sont s&#233;par&#233;s par une rang&#233;e ou une colonne vide. Les num&#233;ros en bleu sont corrects, et ne peuvent pas &#234;tre d&#233;plac&#233;s.<br/>- Les num&#233;ros qui sont en conflit avec d'autres num&#233;ros sur la grille seront identif&#233;s en rouge, et doivent &#234;tre corrig&#233;s pour gagner la partie.<br/>",text.testRules='- Essayez aussi souvent que vous le souhaitez (mais m&#233;fiez-vous du temps qui vous reste pour compl&#233;ter le test!).<br/>- Si vous r&#233;ussissez &#224; gagner, cliquez sur "Soumettre R&#233;ponse" pour recevoir une note parfaite.<br/>');var update=function(e){get("answer").value=e,1==e&&(alert(text.alertText),get("question").submit())};echo("<style type='text/css'>input.const { color:#0000ff;font-weight:bold;text-align:center; } input.cerror { color:#0000ff;font-weight:bold;text-align:center;background:#ff0000; } input.user { text-align:center;background:#ffffff; } input.error { text-align:center;color:#000000;background:#ff0000; }</style>"),echo(text.instruct),isTest&&echo(text.testRules),echo('<br/><form name="sudoku" id="sudoku" action="javascript:checkSoln()"></form>'),draw();