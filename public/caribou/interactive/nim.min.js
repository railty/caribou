function get2(e){return document.getElementById(e)}function echo(e){document.write(e)}function newGame(){rows[1]=a[1],rows[2]=a[2],rows[3]=a[3],rows[4]=a[4],next=6,0==pcCanMoveFirst&&(next=5);for(var e=0;e<suma();e++)get2("i"+e).src=image[2].src}function notOver(){return 0!=rows[1]+rows[2]+rows[3]+rows[4]}function sumrows(){return rows[1]+rows[2]+rows[3]+rows[4]}function suma(){return a[1]+a[2]+a[3]+a[4]}function get(e){for(var t=0,n=1;e>n;n++)t+=a[n];return t}function remove(e){rows[e]--,get2("i"+(get(e)+rows[e])).src=image[1].src}function multiRemove(e){for(;rows[e]<x;)x--,get2("i"+(get(e)+x)).src=image[1].src}function playerMove(e){notOver()&&(5>next&&next!=e?alert(text.startRow+next+text.endRow):0==rows[e]&&alert(text.noMatches),5!=next&&6!=next||0==rows[e]||(next=e),next==e&&0!=rows[e]&&remove(e),notOver()||(update(2),newGame()))}function rand(e){var t=new Date,n=t.getSeconds();return Math.floor(n%e+1)}function winningPosition(){var e=0==(rows[1]^rows[2]^rows[3]^rows[4]),t=1==(rows[1]|rows[2]|rows[3]|rows[4]);return e^t}function compMove(){if(notOver()){if(5!=next)if(next=5,r=rand(4),winningPosition()){for(;0==rows[r];)r=r%4+1;remove(r)}else{for(;!winningPosition();){for(r=r%4+1;0==rows[r];)r=r%4+1;for(x=rows[r];!winningPosition()&&0!=rows[r];)rows[r]--;winningPosition()||(rows[r]=x)}multiRemove(r,x)}else alert(text.yourTurn);notOver()||update(1)}}function draw(){for(var e=get2("nim"),t='<table border="0" cellpadding="1" cellspacing="1">',n=0,i=1;4>=i;i++)if(!(a[i]<=0)){var r=0;t+='<tr height="70" align="center" valign="top">';for(var s=0;9>s;s++)r<a[i]?(t=t+'<td width="32"><img id="i'+n+'" alt=""/></td>',r++,n++):t+='<td width="32"></td>';t=t+'<td width="60" align="right" valign="middle"><input type="button" onclick="playerMove('+i+')" value="'+text.row+i+'"/></td>',t+="</tr>"}t+='<tr align="center" valign="middle">',t=t+'<td height="70" colspan="9"><input type="button" onclick="newGame()" value="'+text.newGame+'"/></td>',t=t+'<td height="70"><input type="button" onclick="compMove()" value="'+text.compMove+'"/></td>',t+="</tr></table>",e.innerHTML=t,newGame()}if(isTest!==!1)var isTest=!0;if(!lang)var lang="en";isTest&&(pcCanMoveFirst!==!0&&pcCanMoveFirst!==!1&&alert("pcCanMoveFirst HAS IMPROPER FORMAT!!!"),(row[1]<0||row[1]>9)&&alert("row[1] HAS IMPROPER RANGE!!!"),(row[2]<0||row[2]>9)&&alert("row[2] HAS IMPROPER RANGE!!!"),(row[3]<0||row[3]>9)&&alert("row[3] HAS IMPROPER RANGE!!!"),(row[4]<0||row[4]>9)&&alert("row[4] HAS IMPROPER RANGE!!!"),row[4]>0&&0==row[1]&&alert("row[4] HAS VALUE BUT row[1] DOES NOT!!!"),row[4]>0&&0==row[2]&&alert("row[4] HAS VALUE BUT row[2] DOES NOT!!!"),row[4]>0&&0==row[3]&&alert("row[4] HAS VALUE BUT row[3] DOES NOT!!!"),row[3]>0&&0==row[1]&&alert("row[3] HAS VALUE BUT row[1] DOES NOT!!!"),row[3]>0&&0==row[2]&&alert("row[3] HAS VALUE BUT row[2] DOES NOT!!!"),row[2]>0&&0==row[1]&&alert("row[2] HAS VALUE BUT row[1] DOES NOT!!!"));var text=new Object;"en"==lang?(text.alertText="You won! Congratulations! Don't forget to submit your answer below if it is not submitted automatically.",text.lose="Sorry, I won. You can try to win again.",text.startRow="You can only remove matches from one row at a time. You started in Row ",text.endRow=", you must continue removing matches from this row, or let the computer have it's turn.",text.noMatches="There are no more matches in this row.",text.yourTurn="It is your turn to remove at least one match.",text.row="Row ",text.newGame="New Game",text.compMove="Computer Move",text.instruct="- From one row, take as many matches as you want by clicking it's row button.<br/>- Then click \"Computer Move\" to let the computer make it's move.<br/>- The one who takes the last match loses.<br/>",text.compMoveFirst='- To have the computer start, click "Computer Move" first.<br/>',text.testRules='- Try as often as you like (but beware of the remaining test time!)<br/>- If you manage to win, scroll down, click "Submit Answer", and you will be awarded full marks.<br/>'):"fr"==lang&&(text.alertText="Vous avez gagn\u00E9! Votre victoire sera soumis automatiquement.",text.lose="D\u00E9sol\u00E9, j'ai gagn\u00E9. Veuillez essailler encore?",text.startRow="Vous pouvez seulement enlever des allumettes d'une rang\u00E9e par tour. Vous avez commenc\u00E9 avec la rang\u00E9e ",text.endRow=", il faut continuer à enlever les allumettes de cette rang\u00E9e ou l'aisser l'ordinateur jouer.",text.noMatches="Il n'y a plus d'allumettes dans cette rang\u00E9e.",text.yourTurn="C'est votre tour pour enlever au moins une allumetter.",text.row="Rang ",text.newGame="Recommencez",text.compMove="Tour &#224; l'ordinateur",text.instruct="- Prenez n'importe quel nombre d'allumettes dans une des rang&#233;es.<br/>- Appuyez sur \"Tour &#224; l'ordinateur\" pour laisser l'ordinateur jouer.<br/>- Celui qui prend la dernière allumette perdre.<br/>",text.compMoveFirst="- L'ordinateur peut jouer en premier si \"Tour &#224; l'ordinateur\" est appuy&#233; en premier.<br/>",text.testRules='- Essayez aussi souvent que vous le souhaitez (mais m&#233;fiez-vous du temps qui vous reste pour compl&#233;ter le test!).<br/>- Si vous r&#233;ussissez &#224; gagner, cliquez sur "Soumettre R&#233;ponse" pour recevoir une note parfaite.<br/>');for(var r,x,next,a=new Array,i=1;4>=i;i++)a[i]=row[i];var rows=new Array,image=new Array;image[1]=new Image,image[2]=new Image,image[1].src="/caribou/games/images/nim/empty.gif",image[2].src="/caribou/games/images/nim/match.gif";var update=function(e){get2("answer").value=e,1==e?(alert(text.alertText),get2("question").submit()):alert(text.lose)};echo(text.instruct),pcCanMoveFirst&&echo(text.compMoveFirst),isTest&&echo(text.testRules),echo("<br/>"),echo('<center><form id="nim"></form></center>'),draw();