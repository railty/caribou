function get(e){return document.getElementById(e)}function echo(e){document.write(e)}function Turn(e,t){total++;var n=text.totalClicks+total;cmode>0&&(get("totalc").innerHTML=n);var i=e+"."+t;if(2==Board[e][t]?(Board[e][t]=1,get(i).src=black):(Board[e][t]=2,get(i).src=light),width>e+1&&2==Board[e+1][t]?(Board[e+1][t]=1,i=e+1+"."+t,get(i).src=black):width>e+1&&1==Board[e+1][t]&&(Board[e+1][t]=2,i=e+1+"."+t,get(i).src=light),e>0&&2==Board[e-1][t]?(Board[e-1][t]=1,i=e-1+"."+t,get(i).src=black):e>0&&1==Board[e-1][t]&&(Board[e-1][t]=2,i=e-1+"."+t,get(i).src=light),height>t+1&&2==Board[e][t+1]){Board[e][t+1]=1;var a=t+1;i=e+"."+a,get(i).src=black}else if(height>t+1&&1==Board[e][t+1]){Board[e][t+1]=2;var a=t+1;i=e+"."+a,get(i).src=light}if(t>0&&2==Board[e][t-1]){Board[e][t-1]=1;var a=t-1;i=e+"."+a,get(i).src=black}else if(t>0&&1==Board[e][t-1]){Board[e][t-1]=2;var a=t-1;i=e+"."+a,get(i).src=light}for(var r=0,o=0;width>o;o++)for(var s=0;height>s;s++)1!=Board[o][s]&&r++;r==width*height?update(1):cmode>0&&total>=cmode&&(alert(text.lose),update(2),adjust())}function adjust(){for(var e=0;width>e;e++)for(var t=0;height>t;t++)Board[e][t]=copyB[e][t];total=0;var n=text.totalClicks+total;cmode>0&&(get("totalc").innerHTML=n);for(var i=get("tdiv"),a="<table width='"+width+"' bgcolor='#FFA500' bordercollapse:collapse cellpadding='0' cellspacing='0'>"+"<tr style='height:4px'><td bgcolor='#FFA500'></td></tr>",e=0;width>e;e++){a+="<tr>";for(var t=0;height>t;t++){var r=e+"."+t;a+=1==Board[e][t]?"<td bgcolor='#FFA500'>&nbsp;</td><td><img id='"+r+"'"+"src='"+black+"' alt='' "+"onclick='Turn("+e+","+t+")'"+"/></td>":2==Board[e][t]?"<td bgcolor='#FFA500'>&nbsp;</td><td><img id='"+r+"' "+"src='"+light+"' alt='' "+"onclick='Turn("+e+","+t+")'"+"/></td>":"<td bgcolor='#FFA500'>&nbsp;</td><td><img id='ledm0' src='"+red+"' alt=''/></td>"}a+="<td bgcolor='#FFA500'>&nbsp;</td></tr><tr style='height:4px'><td bgcolor='#FFA500'></td></tr>"}a+="</table>",i.innerHTML=a}function DrawBoard(){echo('<center xmlns="http://www.w3.org/1999/html"><div id="whole" style="width:500px;overflow:hidden;margin:0 auto;"><h2><font color="#B452CD">'+text.lights+"</font></h2><p>"+text.instruct),1==bool&&echo(text.purple),echo(text.winc+"</p>"+'<div id="tdiv">'),echo('<table width="'+width+'" bgcolor="#FFA500" bordercollapse:collapse cellpadding="0" cellspacing="0">'),echo('<tr style="height:4px"><td bgcolor="#FFA500"></td></tr>');for(var e=0;width>e;e++){echo("<tr>");for(var t=0;height>t;t++){var n=e+"."+t;1==Board[e][t]?(echo('<td bgcolor="#FFA500">&nbsp;</td>'),echo('<td><img id="'+n+'" src="'+black+'" alt="" onclick="Turn('+e+","+t+')"/></td>')):2==Board[e][t]?(echo('<td bgcolor="#FFA500">&nbsp;</td>'),echo('<td><img id="'+n+'" src="'+light+'" alt="" onclick="Turn('+e+","+t+')"/></td>')):(echo('<td bgcolor="#FFA500">&nbsp;</td>'),echo('<td><img id="ledm0" src="'+red+'" alt=""/></td>'))}echo('<td bgcolor="#FFA500">&nbsp;</td>'),echo("</tr>"),echo('<tr style="height:4px"><td bgcolor="#FFA500"></td></tr>')}var i;i=cmode>0?"</table></div><br/><a id='wc'>"+text.clickMode+"</a><br/>"+"<b id='totalc'>"+text.totalClicks+total+"</b><br/>":"</table></div><br/><a id='wc'> </a><br/>",echo(i),echo('</div><br/><img id="sjpg" src="'+res+'" alt="" onclick="adjust()"/></center>')}var width=Board.length,height=Board[0].length,total=0,bool=!1,res="/caribou/games/images/lights/restart.jpg",black="/caribou/games/images/lights/square_empty.png",light="/caribou/games/images/lights/square_light.png",red="/caribou/games/images/lights/square_const.png";copyB=new Array;for(var i=0;width>i;i++)copyB[i]=new Array;for(var i=0;width>i;i++)for(var j=0;height>j;j++)0==Board[i][j]&&(bool=!0),copyB[i][j]=Board[i][j];if(!lang)var lang="en";var text=new Object;"en"==lang?(text.alertText="You won! Congratulations! Don't forget to submit your answer below if it is not submitted automatically.",text.totalClicks="Total number of your clicks: ",text.lose="We are sorry you lost! -_-",text.lights="LIGHTS",text.instruct="Clicking a box changes the lighting in that box and all neighbouring boxes, from dark to light or light to dark.",text.purple="Purple lights are always on and not clickable.",text.winc="<br/><b> >> You win if all lights are on. << </b>",text.clickMode="Restriction: You have to switch all lights on within "+cmode+" clicks"):"fr"==lang&&(text.alertText="Vous avez gagn\u00E9! Votre victoire sera soumis automatiquement.",text.totalClicks="Nombre total de clics&#58; ",text.lose="Vous avez perdu le jeu! -_-",text.lights="JEU DE LUMI&#200;RES",text.instruct="Cliquant sur une case change l&#39;&#233;clairage dans cette case et toutes les cases voisines de l&#39;obscurit&#233; &#224; la lumi&#232;re ou de la lumi&#232;re &#224; l&#39;obscurit&#233;&#46;",text.purple="Les lumi&#232;res violettes sont toujours allum&#233;es et non&#45;cliquables&#46;",text.winc="<br/><b> >> &#62;&#62; Ce jeu est gagn&#233; si toutes les lumi&#232;res sont allum&#233;es &lt;&lt; << </b>",text.clickMode="Restriction&#58; Vous devez allumer toutes les lumi&#232;res en "+cmode+" clics",res="/caribou/games/images/lights/frestart.jpg");var update=function(e){get("answer").value=e,1==e&&(alert(text.alertText),get("question").submit())};DrawBoard();