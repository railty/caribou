function preload(){this.length=preload.arguments.length;for(var e=0;e<this.length;e++)this[e]=new Image,this[e].src=imgdir+preload.arguments[e]}function get(e){return document.getElementById(e)}function echo(e){document.write(e)}function initboard(e,t){var n=board[0].length;for(selectedc=null,selectedr=null,game_is_over=!1,endpost=0>e-1?maxposts-1:e-1,i=0;n>i;i++)board[0][i]=0,board[1][i]=0,board[2][i]=0;for(i=n-t,j=0;n>i;i++,j++)board[e][i]=n-j-1}function drawall(){for(j=0;j<board.length;j++)for(i=0;i<board[j].length;i++)draw(j,i,getName(board[j][i]));message(text.begin)}function init_moves(){moves=0,document.disp.move_count.innerHTML=text.moves+moves}function restart(e){startpost=e,solveit=!1,isTest||(disks=document.disp.disc.options[document.disp.disc.selectedIndex].text),initboard(startpost,disks),init_moves(),drawall(),theAnim=new Animation}function getName(e){return 0==e?"post.gif":"disk"+e+".gif"}function message(e,t){(t||!game_is_over&&!show_messages)&&(document.disp.message.innerHTML=e)}function move_count(){game_is_over||(moves++,document.disp.move_count.innerHTML=text.moves+moves)}function isempty(e){for(i=0;i<board[e].length;i++)if(0!=board[e][i])return!1;return!0}function topmost(e){for(i=0;i<board[e].length;i++)if(0!=board[e][i])return i;return-1}function ispost(e,t){return 0==board[t][e]}function istopdisk(e,t){return 0==board[t][e-1]}function drawboard(){for("none"==type?echo(text.rulesNone+text.instruct):"moves"==type?echo(text.rulesMoves+text.instruct):"post"==type?echo(text.rulesPost+text.instruct):"both"==type&&echo(text.rulesBoth+text.instruct),isTest&&echo(text.testRules),echo('<center><table cellspacing="0" cellpadding="0" border="0">'),echo("<tr>"),j=0;j<board.length;j++){for(echo("<td align=center>"),echo('<a href="javascript:clicked(0,'+j+')"><img src="'+imgdir+'posttop.gif" alt="" border="0"/></a><br/>'),i=0;i<board[0].length;i++)echo('<a href="javascript:clicked('+i+","+j+')">'),echo('<img src="'+imgdir+getName(board[j][i])+'" alt="" name="pos'+j+i+'" border="0"/><br/>'),echo("</a>");echo("</td>")}echo("</tr></table>"),echo('<form name="disp"><textarea name="message" wrap="virtual" rows="2" cols="40"></textarea><br/>');var e="fr"==lang?20:10;"moves"!=type&&"both"!=type&&isTest?echo('<input type="hidden" name="move_count"/>'):echo('<textarea name="move_count" wrap="virtual" rows="1" cols="'+e+'"></textarea><br/>'),isTest?echo('<input type="button" id="rstart" name="rstart" value="'+text.restart+'" onclick="restart(1)"/></form></center>'):echo('Disks: <select name="disc" size=1><option>2<option>3<option selected>4<option>5<option>6<option>7</select><input type=button value="Start the Game Over" onclick="restart(startpost);"/><input type=button value="Solve It!" onclick="restart(startpost);setTimeout(\'hanoi(disks,startpost,endpost)\',300)"/></form></center>')}function draw(e,t,i){document.images["pos"+e+t].src=imgdir+i}function animate(e,t,i){theAnim.addFrame("pos"+e+t,imgdir+i)}function clicked(e,t){return game_is_over&&restart(startpost=endpost),!isselection()&&ispost(e,t)?(message(text.selectDisk),void 0):ispost(e,t)?ispost(e,t)&&selectedc==t?(message(text.moveDisk),void 0):legalmove(t)?(move(t),void 0):(message(text.illegalMove),void 0):(toggle(t),void 0)}function legalmove(e){return isempty(e)?!0:board[e][topmost(e)]<board[selectedc][selectedr]}function isselection(){return null!=selectedc}function toggle(e){var t=topmost(e);selectedc==e&&selectedr==t&&(selectedc=null,selectedr=null,animate(e,t,"disk"+board[e][t]+".gif"),message(text.selectDisk)),isselection()&&animate(selectedc,selectedr,"disk"+board[selectedc][selectedr]+".gif"),selectedc=e,selectedr=t,animate(e,t,"disk"+board[e][t]+"h.gif"),message(text.moveDisk2)}function move(e){var t=isempty(e)?board[e].length:topmost(e);board[e][t-1]=board[selectedc][selectedr],board[selectedc][selectedr]=0,animate(selectedc,selectedr,"post.gif"),animate(e,t-1,"disk"+board[e][t-1]+".gif"),selectedc=null,selectedr=null,message(text.selectDisk),move_count(),game_over()}function game_over(e){var t=null,i=0;for(k=0;k<board.length;k++)i+=isempty(k)?1:0,isempty(k)||(t=k);return 2==i&&isempty(startpost)&&(endpost=t,"moves"==type?moves<=Math.pow(2,disks)-1?(message(text.winMoves,e),update(1)):(message(text.loseMoves,e),update(2)):"post"==type?0==endpost?(message(text.winPost,e),update(1)):(message(text.losePost,e),update(2)):"both"==type?moves<=Math.pow(2,disks)-1&&0==endpost?(message(text.winBoth,e),update(1)):moves>Math.pow(2,disks)-1?(message(text.loseMoves,e),update(2)):0!=endpost?(message(text.losePost,e),update(2)):(message(text.lose,e),update(2)):solveit?message("Now that you've seen the best way, try it yourself!",e):(isTest?message(text.win,e):moves<=Math.pow(2,disks)-1?message("You won in the least number of moves possible! Congratulations!",e):message("You won! But it is possible to win in a few number of moves.",e),update(1)),game_is_over=!0),game_is_over}function Animation(){this.imageNum=new Array,this.imageSrc=new Array,this.frameIndex=0,this.alreadyPlaying=!1,this.getFrameCount=getframecount,this.moreFrames=moreframes,this.addFrame=addframe,this.drawNextFrame=drawnextframe,this.startAnimation=startanimation}function getframecount(){return this.imageNum.length}function moreframes(){return this.frameIndex<this.getFrameCount()}function startanimation(){this.alreadyPlaying||(theAnim.alreadyPlaying=!0,setTimeout("theAnim.drawNextFrame()",5))}function addframe(e,t){var i=theAnim.imageNum.length;theAnim.imageSrc[i]=t,theAnim.imageNum[i]=e,theAnim.startAnimation()}function drawnextframe(){theAnim.moreFrames()?(document.images[theAnim.imageNum[theAnim.frameIndex]].src=theAnim.imageSrc[theAnim.frameIndex],theAnim.frameIndex++,setTimeout("theAnim.drawNextFrame()",30)):theAnim.alreadyPlaying=!1}if((2>numDisks||numDisks>7)&&alert("numDisks HAS IMPROPER RANGE!!!"),"moves"!=questionType&&"post"!=questionType&&"both"!=questionType&&"none"!=questionType&&alert("questionType HAS IMPROPER FORMAT!!!"),isTest!==!1)var isTest=!0;if(!lang)var lang="en";imgdir="/caribou/games/images/hanoi/";var pics=new preload("disk1.gif","disk2.gif","disk3.gif","disk4.gif","disk5.gif","disk6.gif","disk7.gif","disk1h.gif","disk2h.gif","disk3h.gif","disk4h.gif","disk5h.gif","disk6h.gif","disk7h.gif"),moves=0,selectedr=null,selectedc=null,maxposts=3,maxdisks=7,all_posts=3,startpost=1,endpost=0>startpost-1?maxposts-1:startpost-1,disks=numDisks,type=questionType,imgwidth=160,imgheight=14,solveit=!1,game_is_over=!1,show_messages=!1,board=new Array(maxposts);board[0]=new Array(maxdisks+1),board[1]=new Array(maxdisks+1),board[2]=new Array(maxdisks+1);var text=new Object;"en"==lang?(text.alertText="You won! Congratulations! Don't forget to submit your answer below if it is not submitted automatically.",text.begin="You may begin! Select a disk to move.",text.moves="Moves..: ",text.rulesNone="- Move the tower of disks from one post to any other.<br/>",text.rulesMoves="- Move the tower of disks from one post <b><i>to any other post in the fewest number of moves</i></b>.<br/>",text.rulesPost="- Move the tower of disks from the center post <b><i>to the left post</i></b>.<br/>",text.rulesBoth="- Move the tower of disks from the center post <b><i>to the left post in the fewest number of moves</i></b>.<br/>",text.instruct="- Click on a pile of disks to select the top disk, and click the post you wish to move that disk to.<br/>- You cannot move a larger disk on top of a smaller disk.<br/>",text.testRules='- Try as often as you like (but beware of the remaining test time!)<br/>- If you manage to win, scroll down, click "Submit Answer", and you will be awarded full marks.<br/>',text.restart="Restart Question",text.selectDisk="Select a disk to move.",text.moveDisk="Move the disk to a different post.",text.moveDisk2="Click on the post to which you want to move the disk.",text.illegalMove="That is not a legal move. You cannot move a larger disk on top of a smaller disk.",text.winMoves='You won in the fewest possible moves! Congratulations! Click "Submit Answer" to submit the win.',text.loseMoves="Although you relocated the tower, it is possible in fewer moves. You may try again.",text.winPost='You moved the tower to the correct post! Good work! Click "Submit Answer" to submit the win.',text.losePost="You moved the tower to the incorrect post. You must move it to the left post to get full marks. You can try again.",text.winBoth='You moved the tower to the correct post in the fewest possible moves! Well done! Click "Submit Answer" to submit the win.',text.lose="You may try again.",text.win="You won! Congratulations!"):"fr"==lang&&(text.alertText="Vous avez gagn\u00E9! Votre victoire sera soumis automatiquement.",text.begin="Choisissez un disque pour commencer",text.moves="D&#233;placements..: ",text.rulesNone="- D&#233;placez la tour de disques d'un piquet &#224; un autre.<br/>",text.rulesMoves="- D&#233;placez la tour de disques d'un piquet <b><i>&#224; un autre piquet avec le moindre de mouvements possibles.</i></b><br/>",text.rulesPost="- D&#233;placez la tour de disques du piquet central <b><i>vers le piquet gauche</i></b>.<br/>",text.rulesBoth="- D&#233;placez la tour de disques du piquet central <b><i>au piquet gauche avec le moindre de coups possibles</i></b>.<br/>",text.instruct="- Cliquez sur une pile de disques pour s&#233;lectionner le disque du haut de la pile et cliquez sur le piquet o&#249; vous aimeriez le d&#233;placer.<br/>- Vous ne pouvez pas bouger un plus gros disque sur un plus petit disque.<br/>",text.testRules='- Essayez aussi souvent que vous le souhaitez (mais m&#233;fiez-vous du temps qui vous reste pour compl&#233;ter le test!).<br/>- Si vous r&#233;ussissez &#224; gagner, cliquez sur "Soumettre R&#233;ponse" pour recevoir une note parfaite.<br/>',text.restart="Recommencez question",text.selectDisk="S&#233;lectionnez un disque pour jouer.",text.moveDisk="D&#233;placer le disque &#224; un piquet diff&#233;rent.",text.moveDisk2="Cliquez sur le piquet o&#249; vous voulez d&#233;poser le disque.",text.illegalMove="Ce d&#233;placement n'est pas permi. Un disque plus grand ne peut pas &#234;tre plac&#233; sur un disque plus petit.",text.winMoves="F&#233;licitations! Vous avez gagn&#233; avec le plus petit nombre de d&#233;placements! Appuyer sur 'Soumettre R&#233;ponse' pour soumettre la victoire.",text.loseMoves="Vous avez r&#233;ussi &#224; d&#233;placer la tour, cependant c'est possible de la d&#233;placer en moins de mouvements. Veuillez essaiyer de nouveau?",text.winPost="Bravo! Vous avez d&#233;plac&#233; la tour au bon piquet! Appuyer sur 'Soumettre R&#233;ponse' pour soumettre la victoire.",text.losePost="Vous avez d&#233;plac&#233; la tour au piquet incorrect. Il faut la d&#233;placer au piquet gauche pour recevoire un note d'achèvement. Veuillez essaiyer de nouveau?",text.winBoth='Bravo! Vous avez d&#233;plac&#233; la tour au bon piquet! Appuyer sur "Soumettre R&#233;ponse" pour soumettre la victoire.',text.lose="Veuillez essaiyer de nouveau?",text.win="Bravo!");var update=function(e){get("answer").value=e,1==e&&(get("rstart").type="hidden",alert(text.alertText),get("question").submit())};initboard(startpost,disks),drawboard(),init_moves();var theAnim=new Animation;message(text.begin);